diff -r -u original/krb5-1.10.3/src/kadmin/server/ipropd_svc.c krb5-1.10.3/src/kadmin/server/ipropd_svc.c
--- krb5-1.10.3/src/kadmin/server/ipropd_svc.c	2012-08-09 00:27:55.000000000 +0200
+++ krb5-1.10.3/src/kadmin/server/ipropd_svc.c	2015-03-04 14:47:15.983380347 +0100
@@ -222,24 +222,16 @@
  * Return arg cl str ptr on success, else NULL.
  */
 static char *
-getclhoststr(char *clprinc, char *cl, size_t len)
+getclhoststr(const char *clprinc, char *cl, size_t len)
 {
-    char *s;
-    if ((s = strchr(clprinc, '/')) != NULL) {
-	/* XXX "!++s"?  */
-	if (!++s)
-	    return NULL;
-	if (strlcpy(cl, s, len) >= len)
-	    return NULL;
-	/* XXX Copy with @REALM first, with bounds check, then
-	   chop off the realm??  */
-	if ((s = strchr(cl, '@')) != NULL) {
-	    *s = '\0';
-	    return (cl); /* success */
-	}
-    }
+    const char *s, *e;
 
-    return (NULL);
+    if ((s = strchr(clprinc, '/')) == NULL || (e = strchr(++s, '@')) == NULL ||
+       (size_t)(e - s) >= len)
+       return NULL;
+    memcpy(cl, s, e - s);
+    cl[e - s] = '\0';
+    return (cl);
 }
 
 static kdb_fullresync_result_t *
